running
  '/usr/lib/R/bin/R --no-echo --no-restore --no-save --no-restore --file=test/unit-tests-consistency.R'

Loading required package: Matrix
Loading required package: CVXR

Attaching package: ‘CVXR’

The following object is masked from ‘package:stats’:

    power

Loading required package: doParallel
Loading required package: foreach
Loading required package: iterators
Loading required package: parallel
Loading required package: latex2exp
Loading required package: lpSolveAPI
Loading required package: pracma

Attaching package: ‘pracma’

The following objects are masked from ‘package:CVXR’:

    conv, grad, size

The following objects are masked from ‘package:Matrix’:

    expm, lu, tril, triu

Loading required package: purrr

Attaching package: ‘purrr’

The following object is masked from ‘package:pracma’:

    cross

The following objects are masked from ‘package:foreach’:

    accumulate, when

The following object is masked from ‘package:CVXR’:

    is_vector

Loading required package: ROI
ROI: R Optimization Infrastructure
Registered solver plugins: nlminb.
Default solver: auto.

Attaching package: ‘ROI’

The following objects are masked from ‘package:CVXR’:

    constraints, constraints<-, objective, objective<-

Loading required package: tidyverse
Found more than one class "atomicVector" in cache; using the first, from namespace 'Matrix'
Also defined by ‘Rmpfr’
Found more than one class "atomicVector" in cache; using the first, from namespace 'Matrix'
Also defined by ‘Rmpfr’
Found more than one class "atomicVector" in cache; using the first, from namespace 'Matrix'
Also defined by ‘Rmpfr’
Found more than one class "atomicVector" in cache; using the first, from namespace 'Matrix'
Also defined by ‘Rmpfr’
Found more than one class "atomicVector" in cache; using the first, from namespace 'Matrix'
Also defined by ‘Rmpfr’
Found more than one class "atomicVector" in cache; using the first, from namespace 'Matrix'
Also defined by ‘Rmpfr’
Found more than one class "atomicVector" in cache; using the first, from namespace 'Matrix'
Also defined by ‘Rmpfr’
Found more than one class "atomicVector" in cache; using the first, from namespace 'Matrix'
Also defined by ‘Rmpfr’
Found more than one class "atomicVector" in cache; using the first, from namespace 'Matrix'
Also defined by ‘Rmpfr’
Found more than one class "atomicVector" in cache; using the first, from namespace 'Matrix'
Also defined by ‘Rmpfr’
Found more than one class "atomicVector" in cache; using the first, from namespace 'Matrix'
Also defined by ‘Rmpfr’
Found more than one class "atomicVector" in cache; using the first, from namespace 'Matrix'
Also defined by ‘Rmpfr’
── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──
✔ ggplot2 3.3.6     ✔ dplyr   1.0.9
✔ tibble  3.1.7     ✔ stringr 1.4.0
✔ tidyr   1.2.0     ✔ forcats 0.5.1
✔ readr   2.1.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ purrr::accumulate() masks foreach::accumulate()
✖ purrr::cross()      masks pracma::cross()
✖ tidyr::expand()     masks Matrix::expand()
✖ dplyr::filter()     masks stats::filter()
✖ dplyr::id()         masks CVXR::id()
✖ purrr::is_vector()  masks CVXR::is_vector()
✖ dplyr::lag()        masks stats::lag()
✖ tidyr::pack()       masks Matrix::pack()
✖ tidyr::unpack()     masks Matrix::unpack()
✖ purrr::when()       masks foreach::when()
Loading required package: TruncatedNormal

Base relative magnitudes comparison
-----------------------------------

There were 50 or more warnings (use warnings() to see the first 50)
# A tibble: 10 × 5
         lb    ub method Delta    Mbar
      <dbl> <dbl> <chr>  <chr>   <dbl>
 1  0.159   0.233 C-LF   DeltaRM 0    
 2  0.143   0.248 C-LF   DeltaRM 0.222
 3  0.123   0.266 C-LF   DeltaRM 0.444
 4  0.102   0.287 C-LF   DeltaRM 0.667
 5  0.0786  0.308 C-LF   DeltaRM 0.889
 6  0.0551  0.329 C-LF   DeltaRM 1.11 
 7  0.0315  0.352 C-LF   DeltaRM 1.33 
 8  0.00722 0.376 C-LF   DeltaRM 1.56 
 9 -0.0171  0.379 C-LF   DeltaRM 1.78 
10 -0.0422  0.379 C-LF   DeltaRM 2    
Time difference of 1.808198 mins
# A tibble: 5 × 5
       lb    ub method Delta    Mbar
    <dbl> <dbl> <chr>  <chr>   <dbl>
1  0.172  0.232 C-LF   DeltaRM   0  
2  0.131  0.253 C-LF   DeltaRM   0.5
3  0.0707 0.313 C-LF   DeltaRM   1  
4  0.0303 0.354 C-LF   DeltaRM   1.5
5 -0.0303 0.414 C-LF   DeltaRM   2  
Time difference of 18.88231 secs
# A tibble: 5 × 5
       lb    ub method      Delta    Mbar
    <dbl> <dbl> <chr>       <chr>   <dbl>
1  0.172  0.232 Conditional DeltaRM   0  
2  0.131  0.253 Conditional DeltaRM   0.5
3  0.0707 0.313 Conditional DeltaRM   1  
4  0.0303 0.354 Conditional DeltaRM   1.5
5 -0.0303 0.414 Conditional DeltaRM   2  
Time difference of 11.89411 secs
# A tibble: 5 × 5
       lb    ub method Delta    Mbar
    <dbl> <dbl> <chr>  <chr>   <dbl>
1  0.192  0.253 C-LF   DeltaRM   0  
2  0.0707 0.354 C-LF   DeltaRM   0.5
3 -0.0505 0.495 C-LF   DeltaRM   1  
4 -0.192  0.636 C-LF   DeltaRM   1.5
5 -0.333  0.778 C-LF   DeltaRM   2  
Time difference of 17.50653 secs
# A tibble: 5 × 5
       lb    ub method      Delta    Mbar
    <dbl> <dbl> <chr>       <chr>   <dbl>
1  0.192  0.253 Conditional DeltaRM   0  
2  0.0707 0.354 Conditional DeltaRM   0.5
3 -0.0505 0.495 Conditional DeltaRM   1  
4 -0.192  0.636 Conditional DeltaRM   1.5
5 -0.333  0.778 Conditional DeltaRM   2  
Time difference of 3.100529 secs

Base non-rm comparison
----------------------

# A tibble: 10 × 5
       lb    ub method Delta        M
    <dbl> <dbl> <chr>  <chr>    <dbl>
 1 0.131  0.216 FLCI   DeltaSD 0     
 2 0.186  0.330 FLCI   DeltaSD 0.0225
 3 0.175  0.363 FLCI   DeltaSD 0.0449
 4 0.152  0.386 FLCI   DeltaSD 0.0674
 5 0.130  0.408 FLCI   DeltaSD 0.0899
 6 0.107  0.431 FLCI   DeltaSD 0.112 
 7 0.0847 0.453 FLCI   DeltaSD 0.135 
 8 0.0622 0.476 FLCI   DeltaSD 0.157 
 9 0.0397 0.498 FLCI   DeltaSD 0.180 
10 0.0173 0.521 FLCI   DeltaSD 0.202 
Time difference of 28.42638 secs
# A tibble: 4 × 5
       lb    ub method Delta       M
    <dbl> <dbl> <chr>  <chr>   <dbl>
1  0.131  0.216 FLCI   DeltaSD   0  
2  0.119  0.419 FLCI   DeltaSD   0.1
3  0.0194 0.519 FLCI   DeltaSD   0.2
4 -0.0806 0.619 FLCI   DeltaSD   0.3
Time difference of 6.763421 secs
# A tibble: 4 × 5
       lb    ub method      Delta       M
    <dbl> <dbl> <chr>       <chr>   <dbl>
1  0.210  0.328 Conditional DeltaSD   0  
2  0.120  0.418 Conditional DeltaSD   0.1
3  0.0203 0.518 Conditional DeltaSD   0.2
4 -0.0796 0.618 Conditional DeltaSD   0.3
Time difference of 11.22588 secs
# A tibble: 4 × 5
       lb    ub method Delta       M
    <dbl> <dbl> <chr>  <chr>   <dbl>
1  0.206  0.234 C-F    DeltaSD   0  
2  0.120  0.418 C-F    DeltaSD   0.1
3  0.0195 0.518 C-F    DeltaSD   0.2
4 -0.0801 0.618 C-F    DeltaSD   0.3
Time difference of 18.11686 secs
# A tibble: 4 × 5
       lb    ub method Delta       M
    <dbl> <dbl> <chr>  <chr>   <dbl>
1  0.210  0.328 C-LF   DeltaSD   0  
2  0.119  0.419 C-LF   DeltaSD   0.1
3  0.0191 0.519 C-LF   DeltaSD   0.2
4 -0.0809 0.618 C-LF   DeltaSD   0.3
Time difference of 7.239159 secs
There were 24 warnings (use warnings() to see them)
# A tibble: 4 × 5
      lb    ub method Delta       M
   <dbl> <dbl> <chr>  <chr>   <dbl>
1  0.133 0.230 FLCI   DeltaSD   0  
2 -0.186 0.988 FLCI   DeltaSD   0.1
3 -0.686 1.49  FLCI   DeltaSD   0.2
4 -1.19  1.99  FLCI   DeltaSD   0.3
Time difference of 6.811325 secs
# A tibble: 4 × 5
      lb    ub method      Delta       M
   <dbl> <dbl> <chr>       <chr>   <dbl>
1  0.297 0.353 Conditional DeltaSD   0  
2 -0.185 0.853 Conditional DeltaSD   0.1
3 -0.684 1.35  Conditional DeltaSD   0.2
4 -1.19  1.85  Conditional DeltaSD   0.3
Time difference of 3.01206 secs
# A tibble: 4 × 5
      lb    ub method Delta       M
   <dbl> <dbl> <chr>  <chr>   <dbl>
1  0.239 0.251 C-F    DeltaSD   0  
2 -0.185 0.987 C-F    DeltaSD   0.1
3 -0.736 1.49  C-F    DeltaSD   0.2
4 -1.24  1.99  C-F    DeltaSD   0.3
Time difference of 11.48606 secs
# A tibble: 4 × 5
      lb    ub method Delta       M
   <dbl> <dbl> <chr>  <chr>   <dbl>
1  0.297 0.353 C-LF   DeltaSD   0  
2 -0.187 0.853 C-LF   DeltaSD   0.1
3 -0.687 1.35  C-LF   DeltaSD   0.2
4 -1.19  1.85  C-LF   DeltaSD   0.3
Time difference of 4.981331 secs
There were 32 warnings (use warnings() to see them)

Large non-rm comparison
-----------------------

# A tibble: 10 × 5
       lb    ub method Delta       M
    <dbl> <dbl> <chr>  <chr>   <dbl>
 1  0.795 1.76  FLCI   DeltaSD 0    
 2 -2.25  0.192 FLCI   DeltaSD 0.443
 3 -2.68  0.758 FLCI   DeltaSD 0.886
 4 -3.11  1.23  FLCI   DeltaSD 1.33 
 5 -3.55  1.67  FLCI   DeltaSD 1.77 
 6 -3.99  2.11  FLCI   DeltaSD 2.22 
 7 -4.44  2.56  FLCI   DeltaSD 2.66 
 8 -4.88  3.00  FLCI   DeltaSD 3.10 
 9 -5.32  3.44  FLCI   DeltaSD 3.55 
10 -5.77  3.89  FLCI   DeltaSD 3.99 
Time difference of 39.5303 secs
# A tibble: 9 × 5
        lb    ub method Delta       M
     <dbl> <dbl> <chr>  <chr>   <dbl>
1   3.91    8.37 FLCI   DeltaSD 0    
2   2.11    8.16 FLCI   DeltaSD 0.005
3  -0.0829  8.19 FLCI   DeltaSD 0.01 
4  -2.38    8.03 FLCI   DeltaSD 0.015
5  -4.95    7.51 FLCI   DeltaSD 0.02 
6  -8.13    6.22 FLCI   DeltaSD 0.025
7 -10.6     5.55 FLCI   DeltaSD 0.03 
8 -12.8     5.04 FLCI   DeltaSD 0.035
9 -14.1     5.38 FLCI   DeltaSD 0.04 
Time difference of 1.721807 mins
# A tibble: 9 × 5
     lb     ub method      Delta       M
  <dbl>  <dbl> <chr>       <chr>   <dbl>
1 -12.8 -3.95  Conditional DeltaSD 0    
2 -13.5 -3.37  Conditional DeltaSD 0.005
3 -14.3 -2.76  Conditional DeltaSD 0.01 
4 -15.1 -2.12  Conditional DeltaSD 0.015
5 -15.8 -1.47  Conditional DeltaSD 0.02 
6 -16.6 -0.813 Conditional DeltaSD 0.025
7 -17.3 -0.156 Conditional DeltaSD 0.03 
8 -18.1  0.562 Conditional DeltaSD 0.035
9 -18.9  1.27  Conditional DeltaSD 0.04 
Time difference of 54.96887 secs
# A tibble: 9 × 5
       lb      ub method Delta       M
    <dbl>   <dbl> <chr>  <chr>   <dbl>
1   2.95   3.23   C-F    DeltaSD 0    
2   1.40   1.80   C-F    DeltaSD 0.005
3  -0.389  0.198  C-F    DeltaSD 0.01 
4  -2.19  -1.24   C-F    DeltaSD 0.015
5  -4.02  -1.31   C-F    DeltaSD 0.02 
6  -5.91  -0.644  C-F    DeltaSD 0.025
7  -7.90   0.0285 C-F    DeltaSD 0.03 
8 -10.1    0.719  C-F    DeltaSD 0.035
9 -12.6    1.42   C-F    DeltaSD 0.04 
Time difference of 3.110065 mins
# A tibble: 9 × 5
     lb      ub method Delta       M
  <dbl>   <dbl> <chr>  <chr>   <dbl>
1 -12.8 -3.95   C-LF   DeltaSD 0    
2 -13.5 -3.34   C-LF   DeltaSD 0.005
3 -14.3 -2.73   C-LF   DeltaSD 0.01 
4 -15.1 -2.09   C-LF   DeltaSD 0.015
5 -15.8 -1.44   C-LF   DeltaSD 0.02 
6 -16.6 -0.747  C-LF   DeltaSD 0.025
7 -17.3 -0.0868 C-LF   DeltaSD 0.03 
8 -18.1  0.598  C-LF   DeltaSD 0.035
9 -18.9  1.30   C-LF   DeltaSD 0.04 
Time difference of 52.26269 secs
There were 50 or more warnings (use warnings() to see the first 50)
# A tibble: 9 × 5
      lb    ub method Delta       M
   <dbl> <dbl> <chr>  <chr>   <dbl>
1  3.47   6.90 FLCI   DeltaSD 0    
2  2.20   6.66 FLCI   DeltaSD 0.005
3  0.619  6.59 FLCI   DeltaSD 0.01 
4 -1.05   6.37 FLCI   DeltaSD 0.015
5 -2.92   5.88 FLCI   DeltaSD 0.02 
6 -5.27   4.80 FLCI   DeltaSD 0.025
7 -7.03   4.20 FLCI   DeltaSD 0.03 
8 -8.53   3.83 FLCI   DeltaSD 0.035
9 -9.61   3.85 FLCI   DeltaSD 0.04 
Time difference of 1.73358 mins
# A tibble: 9 × 5
     lb      ub method      Delta       M
  <dbl>   <dbl> <chr>       <chr>   <dbl>
1 -10.5 -2.39   Conditional DeltaSD 0    
2 -11.0 -2.02   Conditional DeltaSD 0.005
3 -11.5 -1.60   Conditional DeltaSD 0.01 
4 -12.0 -1.21   Conditional DeltaSD 0.015
5 -12.5 -0.789  Conditional DeltaSD 0.02 
6 -13.0 -0.352  Conditional DeltaSD 0.025
7 -13.5  0.0676 Conditional DeltaSD 0.03 
8 -14.0  0.519  Conditional DeltaSD 0.035
9 -14.5  0.973  Conditional DeltaSD 0.04 
Time difference of 17.54321 secs
# A tibble: 9 × 5
      lb     ub method Delta       M
   <dbl>  <dbl> <chr>  <chr>   <dbl>
1  2.73   2.96  C-F    DeltaSD 0    
2  2.12   2.39  C-F    DeltaSD 0.005
3  0.384  0.829 C-F    DeltaSD 0.01 
4 -0.902 -0.213 C-F    DeltaSD 0.015
5 -2.21  -0.666 C-F    DeltaSD 0.02 
6 -3.57  -0.232 C-F    DeltaSD 0.025
7 -5.00   0.206 C-F    DeltaSD 0.03 
8 -6.59   0.641 C-F    DeltaSD 0.035
9 -8.44   1.11  C-F    DeltaSD 0.04 
Time difference of 2.30983 mins
# A tibble: 9 × 5
     lb      ub method Delta       M
  <dbl>   <dbl> <chr>  <chr>   <dbl>
1 -10.5 -2.43   C-LF   DeltaSD 0    
2 -11.0 -2.02   C-LF   DeltaSD 0.005
3 -11.5 -1.62   C-LF   DeltaSD 0.01 
4 -12.0 -1.19   C-LF   DeltaSD 0.015
5 -12.5 -0.764  C-LF   DeltaSD 0.02 
6 -13.0 -0.352  C-LF   DeltaSD 0.025
7 -13.5  0.0947 C-LF   DeltaSD 0.03 
8 -14.0  0.547  C-LF   DeltaSD 0.035
9 -14.5  1.00   C-LF   DeltaSD 0.04 
Time difference of 2.092718 mins
There were 50 or more warnings (use warnings() to see the first 50)

One post-period
---------------

# A tibble: 4 × 5
        lb     ub method Delta       M
     <dbl>  <dbl> <chr>  <chr>   <dbl>
1 -0.182   -0.106 FLCI   DeltaSD   0  
2  0.192    0.539 FLCI   DeltaSD   0.1
3  0.0919   0.639 FLCI   DeltaSD   0.2
4 -0.00812  0.739 FLCI   DeltaSD   0.3
Time difference of 7.032053 secs
# A tibble: 4 × 5
        lb    ub method      Delta       M
     <dbl> <dbl> <chr>       <chr>   <dbl>
1  0.0801  0.130 Conditional DeltaSD   0  
2  0.0999  0.623 Conditional DeltaSD   0.1
3  0.0790  0.659 Conditional DeltaSD   0.2
4 -0.00768 0.741 Conditional DeltaSD   0.3
Time difference of 0.6709762 secs
# A tibble: 4 × 5
        lb      ub method Delta       M
     <dbl>   <dbl> <chr>  <chr>   <dbl>
1 -0.0923  -0.0899 C-F    DeltaSD   0  
2  0.150    0.581  C-F    DeltaSD   0.1
3  0.0807   0.656  C-F    DeltaSD   0.2
4 -0.00781  0.741  C-F    DeltaSD   0.3
Time difference of 33.48792 secs
# A tibble: 4 × 5
         lb       ub method Delta       M
      <dbl>    <dbl> <chr>  <chr>   <dbl>
1 Inf       -Inf     C-LF   DeltaSD   0  
2   0.125      0.606 C-LF   DeltaSD   0.1
3   0.0775     0.662 C-LF   DeltaSD   0.2
4  -0.00938    0.743 C-LF   DeltaSD   0.3
Time difference of 0.4652054 secs
There were 26 warnings (use warnings() to see them)
# A tibble: 5 × 5
      lb    ub method      Delta    Mbar
   <dbl> <dbl> <chr>       <chr>   <dbl>
1 -0.293 0.551 Conditional DeltaRM   0  
2 -0.295 0.418 Conditional DeltaRM   0.5
3 -0.316 0.454 Conditional DeltaRM   1  
4 -0.365 0.552 Conditional DeltaRM   1.5
5 -0.459 0.552 Conditional DeltaRM   2  
Time difference of 12.23678 secs
# A tibble: 5 × 5
       lb    ub method Delta    Mbar
    <dbl> <dbl> <chr>  <chr>   <dbl>
1  0.0713 0.181 C-LF   DeltaRM   0  
2 -0.0315 0.306 C-LF   DeltaRM   0.5
3 -0.151  0.441 C-LF   DeltaRM   1  
4 -0.278  0.552 C-LF   DeltaRM   1.5
5 -0.411  0.552 C-LF   DeltaRM   2  
Time difference of 6.527547 secs
There were 50 or more warnings (use warnings() to see the first 50)
