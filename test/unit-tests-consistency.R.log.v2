running
  '/usr/lib/R/bin/R --no-echo --no-restore --no-save --no-restore --file=test/unit-tests-consistency.R'

Loading required package: Matrix
Loading required package: CVXR

Attaching package: ‘CVXR’

The following object is masked from ‘package:stats’:

    power

Loading required package: doParallel
Loading required package: foreach
Loading required package: iterators
Loading required package: parallel
Loading required package: latex2exp
Loading required package: lpSolveAPI
Loading required package: pracma

Attaching package: ‘pracma’

The following objects are masked from ‘package:CVXR’:

    conv, grad, size

The following objects are masked from ‘package:Matrix’:

    expm, lu, tril, triu

Loading required package: purrr

Attaching package: ‘purrr’

The following object is masked from ‘package:pracma’:

    cross

The following objects are masked from ‘package:foreach’:

    accumulate, when

The following object is masked from ‘package:CVXR’:

    is_vector

Loading required package: ROI
ROI: R Optimization Infrastructure
Registered solver plugins: nlminb.
Default solver: auto.

Attaching package: ‘ROI’

The following objects are masked from ‘package:CVXR’:

    constraints, constraints<-, objective, objective<-

Loading required package: tidyverse
Found more than one class "atomicVector" in cache; using the first, from namespace 'Matrix'
Also defined by ‘Rmpfr’
Found more than one class "atomicVector" in cache; using the first, from namespace 'Matrix'
Also defined by ‘Rmpfr’
Found more than one class "atomicVector" in cache; using the first, from namespace 'Matrix'
Also defined by ‘Rmpfr’
Found more than one class "atomicVector" in cache; using the first, from namespace 'Matrix'
Also defined by ‘Rmpfr’
Found more than one class "atomicVector" in cache; using the first, from namespace 'Matrix'
Also defined by ‘Rmpfr’
Found more than one class "atomicVector" in cache; using the first, from namespace 'Matrix'
Also defined by ‘Rmpfr’
Found more than one class "atomicVector" in cache; using the first, from namespace 'Matrix'
Also defined by ‘Rmpfr’
Found more than one class "atomicVector" in cache; using the first, from namespace 'Matrix'
Also defined by ‘Rmpfr’
Found more than one class "atomicVector" in cache; using the first, from namespace 'Matrix'
Also defined by ‘Rmpfr’
Found more than one class "atomicVector" in cache; using the first, from namespace 'Matrix'
Also defined by ‘Rmpfr’
Found more than one class "atomicVector" in cache; using the first, from namespace 'Matrix'
Also defined by ‘Rmpfr’
Found more than one class "atomicVector" in cache; using the first, from namespace 'Matrix'
Also defined by ‘Rmpfr’
── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──
✔ ggplot2 3.3.6     ✔ dplyr   1.0.9
✔ tibble  3.1.7     ✔ stringr 1.4.0
✔ tidyr   1.2.0     ✔ forcats 0.5.1
✔ readr   2.1.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ purrr::accumulate() masks foreach::accumulate()
✖ purrr::cross()      masks pracma::cross()
✖ tidyr::expand()     masks Matrix::expand()
✖ dplyr::filter()     masks stats::filter()
✖ dplyr::id()         masks CVXR::id()
✖ purrr::is_vector()  masks CVXR::is_vector()
✖ dplyr::lag()        masks stats::lag()
✖ tidyr::pack()       masks Matrix::pack()
✖ tidyr::unpack()     masks Matrix::unpack()
✖ purrr::when()       masks foreach::when()
Loading required package: TruncatedNormal

Base relative magnitudes comparison
-----------------------------------

There were 50 or more warnings (use warnings() to see the first 50)
# A tibble: 10 × 5
         lb    ub method Delta    Mbar
      <dbl> <dbl> <chr>  <chr>   <dbl>
 1  0.159   0.233 C-LF   DeltaRM 0    
 2  0.143   0.248 C-LF   DeltaRM 0.222
 3  0.123   0.266 C-LF   DeltaRM 0.444
 4  0.102   0.287 C-LF   DeltaRM 0.667
 5  0.0786  0.308 C-LF   DeltaRM 0.889
 6  0.0551  0.329 C-LF   DeltaRM 1.11 
 7  0.0315  0.352 C-LF   DeltaRM 1.33 
 8  0.00722 0.376 C-LF   DeltaRM 1.56 
 9 -0.0171  0.379 C-LF   DeltaRM 1.78 
10 -0.0422  0.379 C-LF   DeltaRM 2    
Time difference of 1.819946 mins
# A tibble: 5 × 5
       lb    ub method Delta    Mbar
    <dbl> <dbl> <chr>  <chr>   <dbl>
1  0.172  0.232 C-LF   DeltaRM   0  
2  0.131  0.253 C-LF   DeltaRM   0.5
3  0.0707 0.313 C-LF   DeltaRM   1  
4  0.0303 0.354 C-LF   DeltaRM   1.5
5 -0.0303 0.414 C-LF   DeltaRM   2  
Time difference of 18.78579 secs
# A tibble: 5 × 5
       lb    ub method      Delta    Mbar
    <dbl> <dbl> <chr>       <chr>   <dbl>
1  0.172  0.232 Conditional DeltaRM   0  
2  0.131  0.253 Conditional DeltaRM   0.5
3  0.0707 0.313 Conditional DeltaRM   1  
4  0.0303 0.354 Conditional DeltaRM   1.5
5 -0.0303 0.414 Conditional DeltaRM   2  
Time difference of 11.95273 secs
# A tibble: 5 × 5
       lb    ub method Delta    Mbar
    <dbl> <dbl> <chr>  <chr>   <dbl>
1  0.212  0.273 C-LF   DeltaRM   0  
2  0.0707 0.414 C-LF   DeltaRM   0.5
3 -0.0909 0.576 C-LF   DeltaRM   1  
4 -0.253  0.737 C-LF   DeltaRM   1.5
5 -0.434  0.919 C-LF   DeltaRM   2  
Time difference of 19.17 secs
# A tibble: 5 × 5
       lb    ub method      Delta    Mbar
    <dbl> <dbl> <chr>       <chr>   <dbl>
1  0.212  0.273 Conditional DeltaRM   0  
2  0.0707 0.414 Conditional DeltaRM   0.5
3 -0.0909 0.576 Conditional DeltaRM   1  
4 -0.253  0.737 Conditional DeltaRM   1.5
5 -0.434  0.919 Conditional DeltaRM   2  
Time difference of 10.7165 secs

Base non-rm comparison
----------------------

# A tibble: 10 × 5
       lb    ub method Delta        M
    <dbl> <dbl> <chr>  <chr>    <dbl>
 1 0.131  0.216 FLCI   DeltaSD 0     
 2 0.186  0.330 FLCI   DeltaSD 0.0225
 3 0.175  0.363 FLCI   DeltaSD 0.0449
 4 0.152  0.386 FLCI   DeltaSD 0.0674
 5 0.130  0.408 FLCI   DeltaSD 0.0899
 6 0.107  0.431 FLCI   DeltaSD 0.112 
 7 0.0847 0.453 FLCI   DeltaSD 0.135 
 8 0.0622 0.476 FLCI   DeltaSD 0.157 
 9 0.0397 0.498 FLCI   DeltaSD 0.180 
10 0.0173 0.521 FLCI   DeltaSD 0.202 
Time difference of 27.47389 secs
# A tibble: 4 × 5
       lb    ub method Delta       M
    <dbl> <dbl> <chr>  <chr>   <dbl>
1  0.131  0.216 FLCI   DeltaSD   0  
2  0.119  0.419 FLCI   DeltaSD   0.1
3  0.0194 0.519 FLCI   DeltaSD   0.2
4 -0.0806 0.619 FLCI   DeltaSD   0.3
Time difference of 7.115787 secs
# A tibble: 4 × 5
       lb    ub method      Delta       M
    <dbl> <dbl> <chr>       <chr>   <dbl>
1  0.210  0.328 Conditional DeltaSD   0  
2  0.120  0.418 Conditional DeltaSD   0.1
3  0.0203 0.518 Conditional DeltaSD   0.2
4 -0.0796 0.618 Conditional DeltaSD   0.3
Time difference of 11.16553 secs
# A tibble: 4 × 5
       lb    ub method Delta       M
    <dbl> <dbl> <chr>  <chr>   <dbl>
1  0.206  0.234 C-F    DeltaSD   0  
2  0.120  0.418 C-F    DeltaSD   0.1
3  0.0195 0.518 C-F    DeltaSD   0.2
4 -0.0801 0.618 C-F    DeltaSD   0.3
Time difference of 18.05662 secs
# A tibble: 4 × 5
       lb    ub method Delta       M
    <dbl> <dbl> <chr>  <chr>   <dbl>
1  0.210  0.328 C-LF   DeltaSD   0  
2  0.119  0.419 C-LF   DeltaSD   0.1
3  0.0191 0.519 C-LF   DeltaSD   0.2
4 -0.0809 0.618 C-LF   DeltaSD   0.3
Time difference of 7.019123 secs
There were 24 warnings (use warnings() to see them)
# A tibble: 4 × 5
      lb    ub method Delta       M
   <dbl> <dbl> <chr>  <chr>   <dbl>
1  0.144 0.260 FLCI   DeltaSD   0  
2 -0.244 1.16  FLCI   DeltaSD   0.1
3 -0.844 1.76  FLCI   DeltaSD   0.2
4 -1.44  2.36  FLCI   DeltaSD   0.3
Time difference of 6.658301 secs
# A tibble: 4 × 5
      lb    ub method      Delta       M
   <dbl> <dbl> <chr>       <chr>   <dbl>
1  0.337 0.442 Conditional DeltaSD   0  
2 -0.243 1.04  Conditional DeltaSD   0.1
3 -0.843 1.64  Conditional DeltaSD   0.2
4 -1.44  2.24  Conditional DeltaSD   0.3
Time difference of 10.87122 secs
# A tibble: 4 × 5
      lb    ub method Delta       M
   <dbl> <dbl> <chr>  <chr>   <dbl>
1  0.270 0.285 C-F    DeltaSD   0  
2 -0.243 1.16  C-F    DeltaSD   0.1
3 -0.842 1.76  C-F    DeltaSD   0.2
4 -1.44  2.36  C-F    DeltaSD   0.3
Time difference of 45.14368 secs
# A tibble: 4 × 5
      lb    ub method Delta       M
   <dbl> <dbl> <chr>  <chr>   <dbl>
1  0.338 0.442 C-LF   DeltaSD   0  
2 -0.243 1.04  C-LF   DeltaSD   0.1
3 -0.843 1.64  C-LF   DeltaSD   0.2
4 -1.44  2.24  C-LF   DeltaSD   0.3
Time difference of 10.31217 secs
There were 32 warnings (use warnings() to see them)

Large non-rm comparison
-----------------------

# A tibble: 10 × 5
       lb    ub method Delta       M
    <dbl> <dbl> <chr>  <chr>   <dbl>
 1  0.795 1.76  FLCI   DeltaSD 0    
 2 -2.25  0.192 FLCI   DeltaSD 0.443
 3 -2.68  0.758 FLCI   DeltaSD 0.886
 4 -3.11  1.23  FLCI   DeltaSD 1.33 
 5 -3.55  1.67  FLCI   DeltaSD 1.77 
 6 -3.99  2.11  FLCI   DeltaSD 2.22 
 7 -4.44  2.56  FLCI   DeltaSD 2.66 
 8 -4.88  3.00  FLCI   DeltaSD 3.10 
 9 -5.32  3.44  FLCI   DeltaSD 3.55 
10 -5.77  3.89  FLCI   DeltaSD 3.99 
Time difference of 36.81249 secs
# A tibble: 9 × 5
        lb    ub method Delta       M
     <dbl> <dbl> <chr>  <chr>   <dbl>
1   3.91    8.37 FLCI   DeltaSD 0    
2   2.11    8.16 FLCI   DeltaSD 0.005
3  -0.0829  8.19 FLCI   DeltaSD 0.01 
4  -2.38    8.03 FLCI   DeltaSD 0.015
5  -4.95    7.51 FLCI   DeltaSD 0.02 
6  -8.13    6.22 FLCI   DeltaSD 0.025
7 -10.6     5.55 FLCI   DeltaSD 0.03 
8 -12.8     5.04 FLCI   DeltaSD 0.035
9 -14.1     5.38 FLCI   DeltaSD 0.04 
Time difference of 1.607398 mins
# A tibble: 9 × 5
     lb     ub method      Delta       M
  <dbl>  <dbl> <chr>       <chr>   <dbl>
1 -12.8 -3.95  Conditional DeltaSD 0    
2 -13.5 -3.37  Conditional DeltaSD 0.005
3 -14.3 -2.76  Conditional DeltaSD 0.01 
4 -15.1 -2.12  Conditional DeltaSD 0.015
5 -15.8 -1.47  Conditional DeltaSD 0.02 
6 -16.6 -0.813 Conditional DeltaSD 0.025
7 -17.3 -0.156 Conditional DeltaSD 0.03 
8 -18.1  0.562 Conditional DeltaSD 0.035
9 -18.9  1.27  Conditional DeltaSD 0.04 
Time difference of 52.33784 secs
# A tibble: 9 × 5
       lb      ub method Delta       M
    <dbl>   <dbl> <chr>  <chr>   <dbl>
1   2.95   3.23   C-F    DeltaSD 0    
2   1.40   1.80   C-F    DeltaSD 0.005
3  -0.389  0.198  C-F    DeltaSD 0.01 
4  -2.19  -1.24   C-F    DeltaSD 0.015
5  -4.02  -1.31   C-F    DeltaSD 0.02 
6  -5.91  -0.644  C-F    DeltaSD 0.025
7  -7.90   0.0285 C-F    DeltaSD 0.03 
8 -10.1    0.719  C-F    DeltaSD 0.035
9 -12.6    1.42   C-F    DeltaSD 0.04 
Time difference of 2.906039 mins
# A tibble: 9 × 5
     lb      ub method Delta       M
  <dbl>   <dbl> <chr>  <chr>   <dbl>
1 -12.8 -3.95   C-LF   DeltaSD 0    
2 -13.5 -3.34   C-LF   DeltaSD 0.005
3 -14.3 -2.73   C-LF   DeltaSD 0.01 
4 -15.1 -2.09   C-LF   DeltaSD 0.015
5 -15.8 -1.44   C-LF   DeltaSD 0.02 
6 -16.6 -0.747  C-LF   DeltaSD 0.025
7 -17.3 -0.0868 C-LF   DeltaSD 0.03 
8 -18.1  0.598  C-LF   DeltaSD 0.035
9 -18.9  1.30   C-LF   DeltaSD 0.04 
Time difference of 45.77384 secs
There were 50 or more warnings (use warnings() to see the first 50)
# A tibble: 9 × 5
       lb    ub method Delta       M
    <dbl> <dbl> <chr>  <chr>   <dbl>
1   4.70   9.24 FLCI   DeltaSD 0    
2   2.56   8.50 FLCI   DeltaSD 0.005
3   0.868  8.83 FLCI   DeltaSD 0.01 
4  -1.36   8.56 FLCI   DeltaSD 0.015
5  -3.85   7.91 FLCI   DeltaSD 0.02 
6  -6.98   6.50 FLCI   DeltaSD 0.025
7  -9.09   5.97 FLCI   DeltaSD 0.03 
8 -11.3    5.34 FLCI   DeltaSD 0.035
9 -12.4    5.68 FLCI   DeltaSD 0.04 
Time difference of 1.861647 mins
# A tibble: 9 × 5
     lb     ub method      Delta       M
  <dbl>  <dbl> <chr>       <chr>   <dbl>
1 -14.5 -3.09  Conditional DeltaSD 0    
2 -15.2 -2.57  Conditional DeltaSD 0.005
3 -15.9 -2.02  Conditional DeltaSD 0.01 
4 -16.5 -1.47  Conditional DeltaSD 0.015
5 -17.2 -0.913 Conditional DeltaSD 0.02 
6 -17.9 -0.304 Conditional DeltaSD 0.025
7 -18.6  0.279 Conditional DeltaSD 0.03 
8 -19.3  0.867 Conditional DeltaSD 0.035
9 -19.9  1.50  Conditional DeltaSD 0.04 
Time difference of 52.25971 secs
# A tibble: 9 × 5
       lb     ub method Delta       M
    <dbl>  <dbl> <chr>  <chr>   <dbl>
1   3.72   4.03  C-F    DeltaSD 0    
2   2.90   3.25  C-F    DeltaSD 0.005
3   0.557  1.15  C-F    DeltaSD 0.01 
4  -1.16  -0.230 C-F    DeltaSD 0.015
5  -2.91  -0.733 C-F    DeltaSD 0.02 
6  -4.72  -0.149 C-F    DeltaSD 0.025
7  -6.64   0.437 C-F    DeltaSD 0.03 
8  -8.74   1.04  C-F    DeltaSD 0.035
9 -11.2    1.67  C-F    DeltaSD 0.04 
Time difference of 2.744591 mins
# A tibble: 9 × 5
     lb     ub method Delta       M
  <dbl>  <dbl> <chr>  <chr>   <dbl>
1 -14.5 -3.12  C-LF   DeltaSD 0    
2 -15.2 -2.57  C-LF   DeltaSD 0.005
3 -15.9 -2.02  C-LF   DeltaSD 0.01 
4 -16.5 -1.47  C-LF   DeltaSD 0.015
5 -17.2 -0.879 C-LF   DeltaSD 0.02 
6 -17.9 -0.304 C-LF   DeltaSD 0.025
7 -18.6  0.316 C-LF   DeltaSD 0.03 
8 -19.3  0.906 C-LF   DeltaSD 0.035
9 -19.9  1.54  C-LF   DeltaSD 0.04 
Time difference of 46.40107 secs
There were 50 or more warnings (use warnings() to see the first 50)

One post-period
---------------

# A tibble: 4 × 5
        lb     ub method Delta       M
     <dbl>  <dbl> <chr>  <chr>   <dbl>
1 -0.182   -0.106 FLCI   DeltaSD   0  
2  0.192    0.539 FLCI   DeltaSD   0.1
3  0.0919   0.639 FLCI   DeltaSD   0.2
4 -0.00812  0.739 FLCI   DeltaSD   0.3
Time difference of 6.385322 secs
# A tibble: 4 × 5
        lb    ub method      Delta       M
     <dbl> <dbl> <chr>       <chr>   <dbl>
1  0.0801  0.130 Conditional DeltaSD   0  
2  0.0999  0.623 Conditional DeltaSD   0.1
3  0.0790  0.659 Conditional DeltaSD   0.2
4 -0.00768 0.741 Conditional DeltaSD   0.3
Time difference of 0.6796813 secs
# A tibble: 4 × 5
        lb      ub method Delta       M
     <dbl>   <dbl> <chr>  <chr>   <dbl>
1 -0.0923  -0.0899 C-F    DeltaSD   0  
2  0.150    0.581  C-F    DeltaSD   0.1
3  0.0807   0.656  C-F    DeltaSD   0.2
4 -0.00781  0.741  C-F    DeltaSD   0.3
Time difference of 31.53543 secs
# A tibble: 4 × 5
         lb       ub method Delta       M
      <dbl>    <dbl> <chr>  <chr>   <dbl>
1 Inf       -Inf     C-LF   DeltaSD   0  
2   0.125      0.606 C-LF   DeltaSD   0.1
3   0.0775     0.662 C-LF   DeltaSD   0.2
4  -0.00938    0.743 C-LF   DeltaSD   0.3
Time difference of 0.4585414 secs
There were 26 warnings (use warnings() to see them)
# A tibble: 5 × 5
      lb    ub method      Delta    Mbar
   <dbl> <dbl> <chr>       <chr>   <dbl>
1 -0.293 0.551 Conditional DeltaRM   0  
2 -0.295 0.418 Conditional DeltaRM   0.5
3 -0.316 0.454 Conditional DeltaRM   1  
4 -0.365 0.552 Conditional DeltaRM   1.5
5 -0.459 0.552 Conditional DeltaRM   2  
Time difference of 12.07265 secs
# A tibble: 5 × 5
       lb    ub method Delta    Mbar
    <dbl> <dbl> <chr>  <chr>   <dbl>
1  0.0713 0.181 C-LF   DeltaRM   0  
2 -0.0315 0.306 C-LF   DeltaRM   0.5
3 -0.151  0.441 C-LF   DeltaRM   1  
4 -0.278  0.552 C-LF   DeltaRM   1.5
5 -0.411  0.552 C-LF   DeltaRM   2  
Time difference of 5.918919 secs
There were 50 or more warnings (use warnings() to see the first 50)
